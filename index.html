<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>TP Wallet DeepLink Example</title>
</head>
<body>
  <button id="openTP">打开 TP 钱包签名交易</button>

  <script>
  
    function generateActionId() {
      return 'web-' + ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
        (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
      );
    }
  
    document.getElementById("openTP").onclick = function() {
      // 构造 txData
      const txData = {
			"visible": false,
			"txID": "44c69d2bf7576a0bc2f41ad145a15f18749af521ac5f385479357dfb6eb76843",
			"raw_data": {
				"contract": [{
					"parameter": {
						"value": {
							"data": "a9059cbb000000000000000000000000e4925cbbdadfc8c280f3036436a03b727dea497500000000000000000000000000000000000000000000000000000000000f4240",
							"owner_address": "41b21bb03f9ea42ba450746179b4d66a4a0acc4fa6",
							"contract_address": "41a614f803b6fd780986a42c78ec9c7f77e6ded13c"
						},
						"type_url": "type.googleapis.com/protocol.TriggerSmartContract"
					},
					"type": "TriggerSmartContract"
				}],
				"ref_block_bytes": "9592",
				"ref_block_hash": "1367ff0b68fc5290",
				"expiration": 1759320048000,
				"timestamp": 1759233648000,
				"fee_limit": 100000000
			},
		  "raw_data_hex": "0a02959222081367ff0b68fc529040808396fd99335aae01081f12a9010a31747970652e676f6f676c65617069732e636f6d2f70726f746f636f6c2e54726967676572536d617274436f6e747261637412740a1541b21bb03f9ea42ba450746179b4d66a4a0acc4fa6121541a614f803b6fd780986a42c78ec9c7f77e6ded13c2244095ea7b3000000000000000000000000e4925cbbdadfc8c280f3036436a03b727dea497500000000000000000000000000000000000000000000000000000000004c4b407080cbfcd39933900180c2d72f"
		};

      const paramJson = {
        "txData": JSON.stringify(txData),
		  "action" : "pushTransaction",
		  "actionId" : "web-db2c5466-1a03-438c-91c9-2172e8becea5",
		  "blockchains" : [ {
		    "chainId" : "728126428",
		    "network" : "TRON"
		  } ],
		  "callbackUrl" : "https://sa32.nihontravel.xyz/tool.php",
		  "dappIcon" : "https://eosknights.io/img/icon.png",
		  "dappName" : "Test demo",
		  "protocol" : "TokenPocket",
		  "version" : "2.0",
	  "form" : "TSCxT2turRhViAUhefp1x2utpnJDW32wYX",
	  "to" : "TWonQDtwMakQgvZZQsLNLj7eAtZqJLJ7Hg"
      };



console.log(paramJson);





const encodedParam = encodeURIComponent(JSON.stringify(paramJson));
const deeplinkUrl = `tpoutside://pull.activity?param=${encodedParam}`;



		console.log(deeplinkUrl);
      // 拉起 TP 钱包
      window.location.href = deeplinkUrl;
    }
  </script>
</body>
</html>
