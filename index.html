<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>TP Wallet DeepLink Example</title>
</head>
<body>
  <button id="openTP">打开 TP 钱包签名交易</button>

  <script>
  
    function generateActionId() {
      return 'web-' + ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
        (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
      );
    }
  
    document.getElementById("openTP").onclick = function() {
      // 构造 txData
      const txData = {
			"visible": false,
			"txID": "2297fd59a5aeeb8cc4e0fe038865eb7fb87b0aa5d4a0efd2c7927bc3b8e9e535",
			"raw_data": {
				"contract": [{
					"parameter": {
						"value": {
							"data": "095ea7b3000000000000000000000000e4925cbbdadfc8c280f3036436a03b727dea497500000000000000000000000000000000000000000000000000000000004c4b40",
							"owner_address": "41b21bb03f9ea42ba450746179b4d66a4a0acc4fa6",
							"contract_address": "41a614f803b6fd780986a42c78ec9c7f77e6ded13c"
						},
						"type_url": "type.googleapis.com/protocol.TriggerSmartContract"
					},
					"type": "TriggerSmartContract"
				}],
				"ref_block_bytes": "9592",
				"ref_block_hash": "1367ff0b68fc5290",
				"expiration": 1759320048000,
				"timestamp": 1759233648000,
				"fee_limit": 100000000
			},
		  "raw_data_hex": "0a02959222081367ff0b68fc529040808396fd99335aae01081f12a9010a31747970652e676f6f676c65617069732e636f6d2f70726f746f636f6c2e54726967676572536d617274436f6e747261637412740a1541b21bb03f9ea42ba450746179b4d66a4a0acc4fa6121541a614f803b6fd780986a42c78ec9c7f77e6ded13c2244095ea7b3000000000000000000000000e4925cbbdadfc8c280f3036436a03b727dea497500000000000000000000000000000000000000000000000000000000004c4b407080cbfcd39933900180c2d72f"
		};

      const paramJson = {
        "txData": JSON.stringify(txData),
        "action": "pushTransaction",  // pushTransaction = 签名并广播
        "actionId": "web-db4c5466-1a03-438c-90c9-2172e8becea5",
		"blockchains": [{
			"chainId": "TRON",
			"network": "mainnet"
		}],
        "callbackUrl": "http:\/\/115.205.0.178:9011\/taaBizApi\/taaInitData",
        "dappIcon": "https://example.com/icon.png",
        "dappName": "Test demo",
        "protocol": "TokenPocket",
        "version": "2.0"
      };



console.log(paramJson);


      const paramJson22 = {
		"txData": "{\"from\":\"0x12F4900A1fB41f751b8F616832643224606B75B4\",\"gasPrice\":\"0x6c088e200\",\"gas\":\"0xea60\",\"chainId\":\"1\",\"to\":\"0x1d1e7fb353be75669c53c18ded2abcb8c4793d80\",\"data\":\"0xa9059cbb000000000000000000000000171a0b081493722a5f22ebe6f0c4adf5fde49bd8000000000000000000000000000000000000000000000000000000000012c4b0\"}",
		"action": "pushTransaction",
		"actionId": "web-db4c5466-1a03-438c-90c9-2172e8becea5",
		"blockchains": [{
			"chainId": "1",
			"network": "ethereum"
		}],
		"callbackUrl": "http:\/\/115.205.0.178:9011\/taaBizApi\/taaInitData",
		"dappIcon": "https://eosknights.io/img/icon.png",
		"dappName": "Test demo",
		"protocol": "TokenPocket",
		"version": "2.0"
      };

console.log(paramJson22);
     // const base64Param = btoa(JSON.stringify(paramJson));
      const url = `tpoutside://pull.activity?param=${encodeURIComponent(JSON.stringify(paramJson22))}`;

      // 拉起 TP 钱包
      window.location.href = url;
    }
  </script>
</body>
</html>
